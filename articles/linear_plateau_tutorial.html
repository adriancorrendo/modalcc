<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="soiltestcorr">
<title>Linear-plateau response • soiltestcorr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linear-plateau response">
<meta property="og:description" content="soiltestcorr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">soiltestcorr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction_to_soiltestcorr.html">Introduction</a>
    <a class="dropdown-item" href="../articles/cate_nelson_1965_tutorial.html">Cate and Nelson (1965)</a>
    <a class="dropdown-item" href="../articles/cate_nelson_1971_tutorial.html">Cate and Nelson (1971)</a>
    <a class="dropdown-item" href="../articles/linear_plateau_tutorial.html">Linear-plateau response</a>
    <a class="dropdown-item" href="../articles/mitscherlich_tutorial.html">Mitscherlich-type response</a>
    <a class="dropdown-item" href="../articles/mod_alcc_tutorial.html">Modified ALCC</a>
    <a class="dropdown-item" href="../articles/quadratic_plateau_tutorial.html">Quadratic-plateau response</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adriancorrendo/soiltestcorr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Linear-plateau response</h1>
                        <h4 data-toc-skip class="author">Adrian Correndo
&amp; Austin Pearce</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adriancorrendo/soiltestcorr/blob/HEAD/vignettes/linear_plateau_tutorial.Rmd" class="external-link"><code>vignettes/linear_plateau_tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>linear_plateau_tutorial.Rmd</code></div>
    </div>

    
    
<p><img src="../reference/figures/soiltestcorr_logo.png" align="right" height="200" style="float:right; height:200px;"></p>
<div class="section level3">
<h3 id="description">Description <br><a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>This tutorial demonstrates the <code><a href="../reference/linear_plateau.html">linear_plateau()</a></code> function
for fitting a continuous response model and estimating a critical soil
test value (CSTV). This function fits a segmented regression model that
follows two phases: i) a linear phase described as
<code>y = a + b * x</code>, followed by ii) a plateau phase (Anderson
and Nelson, 1975) were the <code>ry</code> response to increasing
<code>stv</code> becomes NULL (flat), described as
<code>plateau = y = a + b * Xc</code>, where <code>y</code> represents
the fitted crop relative yield, <code>x</code> the soil test value,
<code>a</code> the intercept (ry when stv = 0) , <code>b</code> the
slope (as the change in RY per unit of soil nutrient supply), and
<code>X_c</code> the break point when the plateau phase starts (i.e. the
CSTV). <br></p>
<p>The parameters of this regression model have a simple interpretation.
Some disadvantages are that: i) the user does not have control to
estimate the CSTV (the model <code>Xc</code> parameter) for an specific
<code>ry</code> level; and ii) the default confidence interval
estimation of the <code>CSTV</code> is generally unreliable (based on
symmetric Wald’s intervals). We recommend the user to apply the
<code><a href="../reference/quadratic_plateau.html">boot_quadratic_plateau()</a></code> function for a reliable confidence
interval estimation of parameters and CSTV via bootstrapping (resampling
with replacement). The <code><a href="../reference/linear_plateau.html">linear_plateau()</a></code> function works
automatically with self-starting initial values to facilitate the
model’s convergence. <br></p>
</div>
<div class="section level3">
<h3 id="general-instructions">General Instructions <br><a class="anchor" aria-label="anchor" href="#general-instructions"></a>
</h3>
<ol style="list-style-type: lower-roman">
<li><p>Load your dataframe with soil test value and relative yield data.
<br></p></li>
<li><p>Specify the following arguments into the function
-linear_plateau()-: <br></p></li>
</ol>
<p>(a). <code>data</code> (optional), <br></p>
<p>(b). <code>stv</code> (soil test value) and <code>ry</code> (relative
yield) columns or vectors, <br></p>
<p>(c). <code>target</code> (optional) if want to know stv level needed
for a different <code>ry</code> than the plateau.</p>
<p>(d). <code>tidy</code> TRUE (produces a data.frame with results) or
FALSE (store results as list), <br></p>
<p>(e). <code>plot</code> TRUE (produces a ggplot as main output) or
FALSE (no plot, only results as data.frame), <br></p>
<p>(f). <code>resid</code> TRUE (produces plots with residuals analysis)
or FALSE (no plot), <br></p>
<ol start="3" style="list-style-type: lower-roman">
<li><p>Run and check results. <br></p></li>
<li><p>Check residuals plot, and warnings related to potential
limitations of this model. <br></p></li>
<li><p>Adjust curve plots as desired. <br></p></li>
</ol>
</div>
<div class="section level2">
<h2 id="tutorial">Tutorial<a class="anchor" aria-label="anchor" href="#tutorial"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adriancorrendo.github.io/soiltestcorr/">soiltestcorr</a></span><span class="op">)</span></span></code></pre></div>
<p>Suggested packages</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install if needed </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># Plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># Data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span> <span class="co"># Data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">utils</span><span class="op">)</span> <span class="co"># Data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span> <span class="co"># Mapping</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span> <span class="co"># Mapping</span></span></code></pre></div>
<p>This is a basic example using three different datasets: <br></p>
<div class="section level3">
<h3 id="load-datasets">Load datasets<a class="anchor" aria-label="anchor" href="#load-datasets"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Example 1 dataset</span></span>
<span><span class="co"># Fake dataset manually created</span></span>
<span><span class="va">data_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="st">"RY"</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">80</span>,<span class="fl">85</span>,<span class="fl">88</span>,<span class="fl">90</span>,<span class="fl">94</span>,<span class="fl">93</span>,<span class="fl">96</span>,<span class="fl">97</span>,<span class="fl">95</span>,<span class="fl">98</span>,<span class="fl">100</span>,<span class="fl">99</span>,<span class="fl">99</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                     <span class="st">"STV"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># Example 2. Native fake dataset from soiltestcorr package</span></span>
<span></span>
<span><span class="va">data_2</span> <span class="op">&lt;-</span> <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="va"><a href="../reference/data_test.html">data_test</a></span></span>
<span></span>
<span></span>
<span><span class="co"># Example 3. Native dataset from soiltestcorr package, Freitas et al.  (1966), used by Cate &amp; Nelson (1971)</span></span>
<span><span class="va">data_3</span> <span class="op">&lt;-</span> <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="va"><a href="../reference/freitas1966.html">freitas1966</a></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="fit-linear_plateau">Fit linear_plateau()<a class="anchor" aria-label="anchor" href="#fit-linear_plateau"></a>
</h2>
<div class="section level3">
<h3 id="individual-fits">1. Individual fits <br><a class="anchor" aria-label="anchor" href="#individual-fits"></a>
</h3>
<div class="section level4">
<h4 id="tidy-false">1.1. <code>tidy</code> = FALSE <br><a class="anchor" aria-label="anchor" href="#tidy-false"></a>
</h4>
<p>It returns a LIST (more efficient for multiple fits at once)
<br></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Using dataframe argument, tidy = FALSE -&gt; return a LIST</span></span>
<span><span class="va">fit_1_tidy_false</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_1</span>, </span>
<span>                               ry <span class="op">=</span> <span class="va">RY</span>, </span>
<span>                               stv <span class="op">=</span> <span class="va">STV</span>, </span>
<span>                               tidy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fit_1_tidy_false</span><span class="op">)</span></span>
<span><span class="co">#&gt; $intercept</span></span>
<span><span class="co">#&gt; [1] 65.87</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $slope</span></span>
<span><span class="co">#&gt; [1] 5.09</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $equation</span></span>
<span><span class="co">#&gt; [1] "65.9 + 5.09x if x&lt;CSTV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plateau</span></span>
<span><span class="co">#&gt; [1] 97.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $target</span></span>
<span><span class="co">#&gt; [1] 97.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CSTV</span></span>
<span><span class="co">#&gt; [1] 6.2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tidy-true">1.2. <code>tidy</code> = TRUE <br><a class="anchor" aria-label="anchor" href="#tidy-true"></a>
</h4>
<p>It returns a data.frame (more organized results) <br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Using dataframe argument, tidy = FALSE -&gt; return a LIST</span></span>
<span><span class="va">fit_1_tidy_true</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_1</span>, </span>
<span>                               ry <span class="op">=</span> <span class="va">RY</span>, </span>
<span>                               stv <span class="op">=</span> <span class="va">STV</span>,</span>
<span>                               tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_1_tidy_true</span></span>
<span><span class="co">#&gt;   intercept slope               equation plateau target CSTV LL_cstv UL_cstv</span></span>
<span><span class="co">#&gt; 1     65.87  5.09 65.9 + 5.09x if x&lt;CSTV    97.4   97.4  6.2     5.1     7.4</span></span>
<span><span class="co">#&gt;               CI_type STVt AIC AICc  R2 pvalue</span></span>
<span><span class="co">#&gt; 1 Wald Conf. Interval  6.2  82   86 0.9      0</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="alternative-using-the-vectors">1.3. Alternative using the vectors <br><a class="anchor" aria-label="anchor" href="#alternative-using-the-vectors"></a>
</h4>
<p>You can call <code>stv</code> and <code>ry</code> vectors using the
<code>$</code>. <br></p>
<p>The <code>tidy</code> argument still applies for controlling the
output type</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fit_1_vectors_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>ry <span class="op">=</span> <span class="va">data_1</span><span class="op">$</span><span class="va">RY</span>,</span>
<span>                               stv <span class="op">=</span> <span class="va">data_1</span><span class="op">$</span><span class="va">STV</span>,</span>
<span>                               tidy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_1_vectors_tidy</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>ry <span class="op">=</span> <span class="va">data_1</span><span class="op">$</span><span class="va">RY</span>,</span>
<span>                               stv <span class="op">=</span> <span class="va">data_1</span><span class="op">$</span><span class="va">STV</span>,</span>
<span>                               tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data-2--test-dataset">1.4. Data 2. Test dataset <br><a class="anchor" aria-label="anchor" href="#data-2--test-dataset"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fit_2</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_2</span>, </span>
<span>                               ry <span class="op">=</span> <span class="va">RY</span>,</span>
<span>                               stv <span class="op">=</span> <span class="va">STV</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fit_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; $intercept</span></span>
<span><span class="co">#&gt; [1] 53.72</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $slope</span></span>
<span><span class="co">#&gt; [1] 1.55</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $equation</span></span>
<span><span class="co">#&gt; [1] "53.7 + 1.55x if x&lt;CSTV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plateau</span></span>
<span><span class="co">#&gt; [1] 96.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $target</span></span>
<span><span class="co">#&gt; [1] 96.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CSTV</span></span>
<span><span class="co">#&gt; [1] 27.4</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data-3--freitas-et-al--1966">1.5. Data 3. Freitas et al. 1966 <br><a class="anchor" aria-label="anchor" href="#data-3--freitas-et-al--1966"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fit_3</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_3</span>, </span>
<span>                               ry <span class="op">=</span> <span class="va">RY</span>,</span>
<span>                               stv <span class="op">=</span> <span class="va">STK</span><span class="op">)</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fit_3</span><span class="op">)</span></span>
<span><span class="co">#&gt; $intercept</span></span>
<span><span class="co">#&gt; [1] 39.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $slope</span></span>
<span><span class="co">#&gt; [1] 0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $equation</span></span>
<span><span class="co">#&gt; [1] "39.2 + 0.75x if x&lt;CSTV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plateau</span></span>
<span><span class="co">#&gt; [1] 95.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $target</span></span>
<span><span class="co">#&gt; [1] 95.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CSTV</span></span>
<span><span class="co">#&gt; [1] 75</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="multiple-fits-at-once">2. Multiple fits at once <br><a class="anchor" aria-label="anchor" href="#multiple-fits-at-once"></a>
</h3>
<div class="section level4">
<h4 id="using-map">2.1. Using map<a class="anchor" aria-label="anchor" href="#using-map"></a>
</h4>
<div class="section level5">
<h5 id="create-nested-data">Create nested data <br><a class="anchor" aria-label="anchor" href="#create-nested-data"></a>
</h5>
<p><i> Note: the <code>stv</code> column needs to have the same name for
all datasets <i></i> <br></i></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># </span></span>
<span><span class="va">data.all</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">data_1</span>, <span class="va">data_2</span>,</span>
<span>                      <span class="va">data_3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>STV <span class="op">=</span> <span class="va">STK</span><span class="op">)</span>,</span>
<span>                     .id <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html" class="external-link">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"STV"</span>, <span class="st">"RY"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="fit">Fit<a class="anchor" aria-label="anchor" href="#fit"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Run multiple examples at once with map()</span></span>
<span><span class="va">fit_multiple_map</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data.all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>linear_plateau <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">data</span>, </span>
<span>                                     <span class="op">~</span> <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>ry <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">RY</span>,</span>
<span>                                                                    stv <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">STV</span>,</span>
<span>                                                                    tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fit_multiple_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   id    data               linear_plateau</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1     <span style="color: #949494;">&lt;tibble [15 × 2]&gt;</span>  <span style="color: #949494;">&lt;df [1 × 14]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2     <span style="color: #949494;">&lt;tibble [137 × 2]&gt;</span> <span style="color: #949494;">&lt;df [1 × 14]&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3     <span style="color: #949494;">&lt;tibble [24 × 2]&gt;</span>  <span style="color: #949494;">&lt;df [1 × 14]&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="using-group_map">2.2. Using group_map <br><a class="anchor" aria-label="anchor" href="#using-group_map"></a>
</h4>
<p>Alternatively, with group_map, we do not require nested data.
<br></p>
<p>However, it requires to dplyr::bind_rows and add an <code>id</code>
column specifying the name of each dataset. <br></p>
<p>This option return models as lists objects.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fit_multiple_group_map</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">data_1</span>, <span class="va">data_2</span>, .id <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>, </span>
<span>                                           ry <span class="op">=</span> <span class="va">RY</span>,</span>
<span>                                           stv <span class="op">=</span> <span class="va">STV</span>,</span>
<span>                                           tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">fit_multiple_group_map</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;   intercept slope               equation plateau target CSTV LL_cstv UL_cstv</span></span>
<span><span class="co">#&gt; 1     65.87  5.09 65.9 + 5.09x if x&lt;CSTV    97.4   97.4  6.2     5.1     7.4</span></span>
<span><span class="co">#&gt;               CI_type STVt AIC AICc  R2 pvalue</span></span>
<span><span class="co">#&gt; 1 Wald Conf. Interval  6.2  82   86 0.9      0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;   intercept slope               equation plateau target CSTV LL_cstv UL_cstv</span></span>
<span><span class="co">#&gt; 1     53.72  1.55 53.7 + 1.55x if x&lt;CSTV    96.2   96.2 27.4      24    30.7</span></span>
<span><span class="co">#&gt;               CI_type STVt  AIC AICc   R2 pvalue</span></span>
<span><span class="co">#&gt; 1 Wald Conf. Interval 27.4 1026 1026 0.52      0</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="bootstrapping">3. Bootstrapping <br><a class="anchor" aria-label="anchor" href="#bootstrapping"></a>
</h3>
<p>A suitable alternative for obtaining confidence intervals for
parameters of derived quantities is bootstrapping. <br></p>
<p>Bootstrapping is a resampling technique (with replacement) that draws
samples from the original data with the same size. If you have groups
within your data, you can specify grouping variables as arguments in
order to maintain, within each resample, the same proportion of
observations than in the original dataset. <br></p>
<p>This function returns a table with as many rows as the resampling
size (n) containing the results for each resample.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">boot_lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linear_plateau.html">boot_linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_1</span>, </span>
<span>                    ry <span class="op">=</span> <span class="va">RY</span>, target <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                    stv <span class="op">=</span> <span class="va">STV</span>, n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: There were 200 warnings in `dplyr::mutate()`.</span></span>
<span><span class="co">#&gt; The first warning was:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In argument: `model = map(...)`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> In group 1: `boot_id = 1`.</span></span>
<span><span class="co">#&gt; Caused by warning:</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> You have specified a relative yield target equal or greater than the CSTV for plateau. </span></span>
<span><span class="co">#&gt;           The CSTV estimations have been changed for the plateau level</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Run `dplyr::last_dplyr_warnings()` to see the 199 remaining warnings.</span></span>
<span></span>
<span><span class="va">boot_lp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head</a></span><span class="op">(</span><span class="va">.</span>, n<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 200 × 15</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   boot_id [200]</span></span></span>
<span><span class="co">#&gt;    boot_id intercept slope equation plateau target  CSTV LL_cstv UL_cstv CI_type</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>       1      66.4  4.5  66.4 + …    98       90   7       5.7     8.3 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>       2      74.4  3.3  74.4 + …    96.5     90   6.7     5.8     7.6 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>       3      63.3  5.64 63.3 + …    97.7     90   6.1     5       7.2 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>       4      79.5  2.06 79.5 + …    98.1     90   9       7.4    10.7 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>       5      56   10    56 + 10…    96.3     90   4       3.5     4.5 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>       6      76.0  2.67 76 + 2.…    97.6     90   8.1     7       9.2 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>       7      60.9  5.19 60.9 + …    98.1     90   7.2     6.3     8   Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>       8      64.1  4.78 64.1 + …    98.4     90   7.2     5.8     8.6 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>       9      66.2  4.28 66.2 + …    98.7     90   7.6     6.4     8.8 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>      10      75.7  2.83 75.7 + …    98.8     90   8.2     7.1     9.2 Wald C…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 190 more rows, and 5 more variables: STVt &lt;dbl&gt;, AIC &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   AICc &lt;dbl&gt;, R2 &lt;dbl&gt;, pvalue &lt;dbl&gt;</span></span></span>
<span></span>
<span><span class="co"># CSTV Confidence Interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">boot_lp</span><span class="op">$</span><span class="va">CSTV</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.5</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   2.5%    50%  97.5% </span></span>
<span><span class="co">#&gt; 4.0975 7.0000 9.9025</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="va">boot_lp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CSTV</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey25"</span>, fill <span class="op">=</span> <span class="st">"#9de0bf"</span>, bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="linear_plateau_tutorial_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="plots">4. Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<div class="section level4">
<h4 id="correlation-curve">4.1. Correlation Curve<a class="anchor" aria-label="anchor" href="#correlation-curve"></a>
</h4>
<p>We can generate a ggplot with the same linear_plateau() function.
<br></p>
<p>We just need to specify the argument <code>plot = TRUE</code>.
<br></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">linear_plateau_plot</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_3</span>, </span>
<span>                               ry <span class="op">=</span> <span class="va">RY</span>, </span>
<span>                               stv <span class="op">=</span> <span class="va">STK</span>, </span>
<span>                               plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linear_plateau_plot</span></span></code></pre></div>
<p><img src="linear_plateau_tutorial_files/figure-html/unnamed-chunk-13-1.png" width="576">
### 4.2. Fine-tune the plots <br></p>
<p>As ggplot object, plots can be adjusted in several ways. <br></p>
<p>For example, modifying titles <br></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_plateau_plot_2</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">linear_plateau_plot</span> <span class="op">+</span></span>
<span>  <span class="co"># Main title</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"My own plot title"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Axis titles</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Soil Test K (ppm)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Cotton RY(%)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linear_plateau_plot_2</span></span></code></pre></div>
<p><img src="linear_plateau_tutorial_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p>Or modifying axis scales <br></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_plateau_plot_3</span> <span class="op">&lt;-</span></span>
<span><span class="va">linear_plateau_plot_2</span> <span class="op">+</span></span>
<span>  <span class="co"># Axis scales</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">220</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">220</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Axis limits</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">100</span>, by <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">linear_plateau_plot_3</span></span></code></pre></div>
<p><img src="linear_plateau_tutorial_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="residuals">4.3. Residuals <br><a class="anchor" aria-label="anchor" href="#residuals"></a>
</h4>
<p>We can generate a plot with the same linear_plateau() function.
<br></p>
<p>We just need to specify the argument <code>resid</code> = TRUE`.
<br></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Residuals plot</span></span>
<span></span>
<span><span class="fu">soiltestcorr</span><span class="fu">::</span><span class="fu"><a href="../reference/linear_plateau.html">linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_3</span>, </span>
<span>                               ry <span class="op">=</span> <span class="va">RY</span>, </span>
<span>                               stv <span class="op">=</span> <span class="va">STK</span>, </span>
<span>                               resid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="linear_plateau_tutorial_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<pre><code><span><span class="co">#&gt; $intercept</span></span>
<span><span class="co">#&gt; [1] 39.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $slope</span></span>
<span><span class="co">#&gt; [1] 0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $equation</span></span>
<span><span class="co">#&gt; [1] "39.2 + 0.75x if x&lt;CSTV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $plateau</span></span>
<span><span class="co">#&gt; [1] 95.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $target</span></span>
<span><span class="co">#&gt; [1] 95.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CSTV</span></span>
<span><span class="co">#&gt; [1] 75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $LL_cstv</span></span>
<span><span class="co">#&gt; [1] 46.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $UL_cstv</span></span>
<span><span class="co">#&gt; [1] 103.6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $CI_type</span></span>
<span><span class="co">#&gt; [1] "Wald Conf. Interval"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $STVt</span></span>
<span><span class="co">#&gt; [1] 75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $AIC</span></span>
<span><span class="co">#&gt; [1] 188</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $AICc</span></span>
<span><span class="co">#&gt; [1] 190</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $R2</span></span>
<span><span class="co">#&gt; [1] 0.66</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pvalue</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre>
<p><b> References </b> <br></p>
<p><em>Anderson, R. L., and Nelson, L. A. (1975). A Family of Models
Involving Intersecting Straight Lines and Concomitant Experimental
Designs Useful in Evaluating Response to Fertilizer Nutrients.
Biometrics, 31(2), 303–318. 10.2307/2529422 </em> <br></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Adrian A. Correndo, Adrian A. Correndo, Austin Pearce, Deanna Osmond, Ignacio A. Ciampitti.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
