<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="soiltestcorr">
<title>Bootstrapping • soiltestcorr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Abel-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrapping">
<meta property="og:description" content="soiltestcorr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">soiltestcorr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/Introduction_to_soiltestcorr.html">
    <span class="fa fa fa fa-magic"></span>
     
    Home
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-gears"></span>
     
    Functions
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--tutorials">
    <span class="fa fa-paperclip"></span>
     
    Tutorials
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--tutorials">
    <a class="dropdown-item" href="../articles/bootstrapping_tutorial.html">Bootstrapping</a>
    <a class="dropdown-item" href="../articles/mod_alcc_tutorial.html">Modified ALCC</a>
    <a class="dropdown-item" href="../articles/cate_nelson_1965_tutorial.html">Cate &amp; Nelson (1965)</a>
    <a class="dropdown-item" href="../articles/cate_nelson_1971_tutorial.html">Cate &amp; Nelson (1971)</a>
    <a class="dropdown-item" href="../articles/linear_plateau_tutorial.html">Linear-plateau</a>
    <a class="dropdown-item" href="../articles/quadratic_plateau_tutorial.html">Quadratic-plateau</a>
    <a class="dropdown-item" href="../articles/mitscherlich_tutorial.html">Mistcherlich</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--more">
    <span class="fa fa-plus"></span>
     
    More
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--more">
    <a class="dropdown-item" href="../articles/SoftwareX_publication.html">SoftwareX publication</a>
    <a class="dropdown-item" href="../articles/Shinyapp.html">Shinyapp</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/adriancorrendo/soiltestcorr/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://adriancorrendo.github.io/">
    <span class="fa fa-user"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bootstrapping</h1>
                        <h4 data-toc-skip class="author">Adrian
Correndo, Austin Pearce</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/adriancorrendo/soiltestcorr/blob/HEAD/vignettes/bootstrapping_tutorial.Rmd" class="external-link"><code>vignettes/bootstrapping_tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>bootstrapping_tutorial.Rmd</code></div>
    </div>

    
    
<p><img src="../reference/figures/soiltestcorr_logo.png" align="right" height="200" style="float:right; height:200px;"></p>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>This tutorial is intended to show how to implement bootstrapping to
the soiltestcorr functions.</p>
</div>
<div class="section level2">
<h2 id="what-is-bootstrapping">What is bootstrapping?<a class="anchor" aria-label="anchor" href="#what-is-bootstrapping"></a>
</h2>
<p>Bootstrapping is a technique introduced in late 1970’s by Bradley
Efron (Efron, 1979). It is a general purpose inferential approach that
is useful for robust estimations, especially when the distribution of a
statistic of quantity of interest is complicated or unknown (Faraway,
2014). It provides an alternative to perform confidence statements while
relaxing the famous assumption of normality (Efron and Tibshirani,
1993). The underlying concept of bootstrapping is that the inference
about a population parameter or quantity can be modeled by “resampling”
the available data.</p>
</div>
<div class="section level2">
<h2 id="how-does-it-work">How does it work?<a class="anchor" aria-label="anchor" href="#how-does-it-work"></a>
</h2>
<p>In <code>soiltestcorr</code>, bootstrapping means resampling cases
with replacement. That means that it draws random samples from the
original data while maintaining the same original size (i.e, some
observations may be included multiple times while others may not be
sampled at all). Let’s suppose that we have a dataset with 50
observations (one per row). We first create
bootstraps/replicates/samples by randomly sampling those 50 observations
many times (e.g., 1,000 times). Each random sample has 50 total
observations, conserving the same number of observations as the original
data (50). Finally, we fit a chosen model to each of the 1000 samples,
which, in the context of soiltestcorr, could result in a distribution of
1,000 estimates of a critical soil test value (CSTV), for example.</p>
<p>In general, the larger the number of observations and resamples, the
more likely we’ll obtain a representative distribution of the
population’s quantity of interest. The minimum number of iterations
generally recommended is <code>n = 1000</code>. The number used is up to
the user, and may represent a compromise between the quality of the
outcomes and the necessary computational power or time for the
iterations. If the final results from 1,000 samples is no different than
10,000 samples, the time savings may warrant fewer samples.</p>
<p>Once the distribution is obtained we may obtain a “summary”
describing “moments” of the distribution such as the “mean”, “median”,
“standard deviation”, “quantiles”, etc.. Very frequently, the general
procedure is to extract the “median” (which is more robust to outliers
than the mean), the 0.025- and 0.975-quantiles from the distribution
(equivalent to 2.5th and 97.5th percentiles) in order to obtain the
conventional 95% confidence interval. This interval in normally used to
test hypotheses of interest (e.g. comparing groups, methods, etc.)</p>
</div>
<div class="section level2">
<h2 id="the-soiltestcorrboot_-functions">The <code>soiltestcorr::boot_()</code> functions<a class="anchor" aria-label="anchor" href="#the-soiltestcorrboot_-functions"></a>
</h2>
<p>You can implement bootstrapping to each of the six soiltestcorr
available models, which count with their own <code>boot_…()</code>
functions:</p>
<ul>
<li><p><code><a href="../reference/mod_alcc.html">boot_mod_alcc()</a></code></p></li>
<li><p><code><a href="../reference/cate_nelson_1965.html">boot_cn_1965()</a></code></p></li>
<li><p><code><a href="../reference/cate_nelson_1971.html">boot_cn_1971()</a></code></p></li>
<li><p><code><a href="../reference/linear_plateau.html">boot_linear_plateau()</a></code></p></li>
<li><p><code><a href="../reference/quadratic_plateau.html">boot_quadratic_plateau()</a></code></p></li>
<li><p><code><a href="../reference/mitscherlich.html">boot_mitscherlich()</a></code></p></li>
</ul>
<p>Each <code>boot_…()</code> function presents the same basic arguments
than their respective original functions (i.e., <code>data</code>,
<code>stv</code>, and <code>ry</code>), with the addition of two
arguments related to the resampling:</p>
<ul>
<li><p><code>n</code>, indicating the number of resamples to perform
iterations.</p></li>
<li><p><code>...</code>, indicating open arguments that allow you to add
grouping variable/s (factor or character) for running the bootstrapping
by group. Be sure that these open arguments are placed by the end of
each function.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>The following is a simple example using a simulated dataset that
contains soil test values (STV) and relative yield (RY) for two
different groups of soil: “clay_loam” and “sandy_loam”.</p>
<p>If you have groups in your data, you can specify the grouping
variable/s as arguments in order to maintain within each bootstrap
sample the same proportion of observations than in the original dataset.
This will return a tibble for each sample with as many rows as the
resampling size (n) containing the results.</p>
<p>The objective in this example is to obtain critical soil test values
(CSTV) with confidence intervals at 90% RY for each of the different
models that soiltestcorr offers.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adriancorrendo.github.io/soiltestcorr/">soiltestcorr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 methods overwritten by 'ggpp':</span></span>
<span><span class="co">#&gt;   method                  from   </span></span>
<span><span class="co">#&gt;   heightDetails.titleGrob ggplot2</span></span>
<span><span class="co">#&gt;   widthDetails.titleGrob  ggplot2</span></span></code></pre></div>
<p><strong>Suggested packages</strong></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install if needed </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># Plots</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span> <span class="co"># Data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span> <span class="co"># Data wrangling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span> <span class="co"># Mapping</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clay loam simulated dataset</span></span>
<span><span class="va">clay_loam</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  <span class="st">"soil"</span> <span class="op">=</span> <span class="st">"clay_loam"</span>,</span>
<span>  <span class="st">"RY"</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">65</span>,<span class="fl">80</span>,<span class="fl">85</span>,<span class="fl">88</span>,<span class="fl">90</span>,<span class="fl">94</span>,<span class="fl">93</span>,<span class="fl">96</span>,<span class="fl">97</span>,<span class="fl">95</span>,<span class="fl">98</span>,<span class="fl">100</span>,<span class="fl">99</span>,<span class="fl">99</span>,<span class="fl">100</span><span class="op">)</span>,</span>
<span>  <span class="st">"STV"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># Sandy loam simulated dataset</span></span>
<span><span class="va">sandy_loam</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  <span class="st">"soil"</span> <span class="op">=</span> <span class="st">"sandy_loam"</span>,</span>
<span>  <span class="st">"RY"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">55</span>,<span class="fl">70</span>,<span class="fl">80</span>,<span class="fl">84</span>,<span class="fl">89</span>,<span class="fl">92</span>,<span class="fl">90</span>,<span class="fl">94</span>,<span class="fl">99</span>,<span class="fl">92</span>,<span class="fl">96</span>,<span class="fl">100</span>,<span class="fl">100</span>,<span class="fl">99</span>,<span class="fl">99</span><span class="op">)</span>, </span>
<span>  <span class="st">"STV"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">16</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Merging soils datasets</span></span>
<span><span class="va">dataframe_soils</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">clay_loam</span>, <span class="va">sandy_loam</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="boot_cn_1965">1. <code>boot_cn_1965()</code><a class="anchor" aria-label="anchor" href="#boot_cn_1965"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">boot_cn_65</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cate_nelson_1965.html">boot_cn_1965</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataframe_soils</span>,</span>
<span>                           stv <span class="op">=</span> <span class="va">STV</span>, ry <span class="op">=</span> <span class="va">RY</span>, </span>
<span>                           target <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                           n <span class="op">=</span> <span class="fl">100</span>, <span class="co"># only 100 replicates to save compute time on demo</span></span>
<span>                           <span class="co"># Group by soil</span></span>
<span>                           soil <span class="op">=</span> <span class="va">soil</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CSTV Confidence Interval</span></span>
<span><span class="va">boot_cn_65_sum</span> <span class="op">&lt;-</span> <span class="va">boot_cn_65</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Obtain quantiles of interest</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>q025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.500</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            q975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot CSTV</span></span>
<span><span class="va">boot_cn_65</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CSTV</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey40"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Draw lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_cn_65_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_cn_65_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q025</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_cn_65_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q975</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"boot_cn_1965()"</span>, x <span class="op">=</span> <span class="st">"CSTV for RY=90%"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrapping_tutorial_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="boot_cn_1971">2. <code>boot_cn_1971()</code><a class="anchor" aria-label="anchor" href="#boot_cn_1971"></a>
</h4>
<p><em>Note: for the Cate &amp; Nelson (1971) approach, it is not
possible to set a RY target for the CSTV estimation. It simply estimates
the most efficient division of the data into the four quadrants in order
to maximize the number of observations into positive quadrants.</em></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">boot_cn_71</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cate_nelson_1971.html">boot_cn_1971</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataframe_soils</span>,</span>
<span>                           stv <span class="op">=</span> <span class="va">STV</span>, ry <span class="op">=</span> <span class="va">RY</span>, </span>
<span>                           n <span class="op">=</span> <span class="fl">100</span>, <span class="co"># only 100 replicates to save compute time on demo</span></span>
<span>                           <span class="co"># Group by soil</span></span>
<span>                           soil <span class="op">=</span> <span class="va">soil</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CSTV Confidence Interval</span></span>
<span><span class="va">boot_cn_71_sum</span> <span class="op">&lt;-</span> <span class="va">boot_cn_71</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="co"># Obtain quantiles of interest</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>q025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.500</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        q975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot CSTV</span></span>
<span><span class="va">boot_cn_71</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CSTV</span>, y <span class="op">=</span> <span class="va">CRYV</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">geom_density_2d</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Draw lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_cn_71_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"boot_cn_1971()"</span>, x <span class="op">=</span> <span class="st">"CSTV for CRYV"</span>, y <span class="op">=</span> <span class="st">"RV (%) at CSTV"</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrapping_tutorial_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="boot_mod_alcc">3. <code>boot_mod_alcc()</code><a class="anchor" aria-label="anchor" href="#boot_mod_alcc"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">boot_alcc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mod_alcc.html">boot_mod_alcc</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataframe_soils</span>,</span>
<span>                           stv <span class="op">=</span> <span class="va">STV</span>, ry <span class="op">=</span> <span class="va">RY</span>,</span>
<span>                           target <span class="op">=</span> <span class="fl">90</span>, n <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                           <span class="co"># Group by id</span></span>
<span>                           soil <span class="op">=</span> <span class="va">soil</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CSTV Confidence Interval</span></span>
<span><span class="va">boot_alcc_sum</span> <span class="op">&lt;-</span> <span class="va">boot_alcc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="co"># Obtain quantiles of interest</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>q025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.500</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        q975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot CSTV</span></span>
<span><span class="va">boot_alcc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CSTV</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey40"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Draw lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_alcc_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_alcc_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q025</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_alcc_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q975</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"boot_mod_alcc()"</span>, x <span class="op">=</span> <span class="st">"CSTV for RY=90%"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrapping_tutorial_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="boot_linear_plateau">2. <code>boot_linear_plateau()</code><a class="anchor" aria-label="anchor" href="#boot_linear_plateau"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">boot_lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linear_plateau.html">boot_linear_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataframe_soils</span>,</span>
<span>                               stv <span class="op">=</span> <span class="va">STV</span>, ry <span class="op">=</span> <span class="va">RY</span>,</span>
<span>                               target <span class="op">=</span> <span class="fl">90</span>, n <span class="op">=</span> <span class="fl">1e3</span>,</span>
<span>                               <span class="co"># Group by soil</span></span>
<span>                               soil <span class="op">=</span> <span class="va">soil</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CSTV Confidence Interval</span></span>
<span><span class="va">boot_lp_sum</span> <span class="op">&lt;-</span> <span class="va">boot_lp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="co"># Obtain quantiles of interest</span></span>
<span>            <span class="co"># Note: for linear_plateau, the CSTV for a specific RY target = STVt</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>q025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">STVt</span>, prob <span class="op">=</span> <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">STVt</span>, prob <span class="op">=</span> <span class="fl">0.500</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        q975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">STVt</span>, prob <span class="op">=</span> <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot STVt</span></span>
<span><span class="va">boot_lp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">STVt</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey40"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Draw lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_lp_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_lp_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q025</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_lp_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q975</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"boot_linear_plateau()"</span>, x <span class="op">=</span> <span class="st">"STVt for RY=90%"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrapping_tutorial_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="boot_quadratic_plateau">3. <code>boot_quadratic_plateau()</code><a class="anchor" aria-label="anchor" href="#boot_quadratic_plateau"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">boot_qp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quadratic_plateau.html">boot_quadratic_plateau</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataframe_soils</span>,</span>
<span>                               stv <span class="op">=</span> <span class="va">STV</span>, ry <span class="op">=</span> <span class="va">RY</span>,</span>
<span>                               target <span class="op">=</span> <span class="fl">90</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                               <span class="co"># Group by soil</span></span>
<span>                               soil <span class="op">=</span> <span class="va">soil</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in nlsModel(formula, mf, start, wts) : </span></span>
<span><span class="co">#&gt;   singular gradient matrix at initial parameter estimates</span></span>
<span><span class="co">#&gt; Error in nlsModel(formula, mf, start, wts) : </span></span>
<span><span class="co">#&gt;   singular gradient matrix at initial parameter estimates</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># CSTV Confidence Interval</span></span>
<span><span class="va">boot_qp_sum</span> <span class="op">&lt;-</span> <span class="va">boot_qp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="co"># Obtain quantiles of interest</span></span>
<span>            <span class="co"># Note: for quad_plateau, the CSTV for a specific RY target = STVt</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>q025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">STVt</span>, prob <span class="op">=</span> <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">STVt</span>, prob <span class="op">=</span> <span class="fl">0.500</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        q975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">STVt</span>, prob <span class="op">=</span> <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot STVt</span></span>
<span><span class="va">boot_qp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">STVt</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey40"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Draw lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_qp_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_qp_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q025</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_qp_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q975</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"boot_quadratic_plateau()"</span>, x <span class="op">=</span> <span class="st">"CSTV for RY=90%"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrapping_tutorial_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div class="section level4">
<h4 id="boot_mitscherlich">4. <code>boot_mitscherlich()</code><a class="anchor" aria-label="anchor" href="#boot_mitscherlich"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">boot_mits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mitscherlich.html">boot_mitscherlich</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dataframe_soils</span>,</span>
<span>                               stv <span class="op">=</span> <span class="va">STV</span>, ry <span class="op">=</span> <span class="va">RY</span>, type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                               target <span class="op">=</span> <span class="fl">90</span>, n <span class="op">=</span> <span class="fl">1e3</span>,</span>
<span>                               <span class="co"># Group by soil</span></span>
<span>                               soil <span class="op">=</span> <span class="va">soil</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CSTV Confidence Interval</span></span>
<span><span class="va">boot_mits_sum</span> <span class="op">&lt;-</span> <span class="va">boot_mits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">soil</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>            <span class="co"># Obtain quantiles of interest</span></span>
<span>              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>q025 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.500</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                        q975 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">CSTV</span>, prob <span class="op">=</span> <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot CSTV</span></span>
<span><span class="va">boot_mits</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CSTV</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"grey40"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="co"># Draw lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_mits_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">median</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_mits_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q025</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">boot_mits_sum</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">q975</span>, color <span class="op">=</span> <span class="va">soil</span><span class="op">)</span>,</span>
<span>              linetype <span class="op">=</span> <span class="st">"dotted"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"boot_mitscherlich()"</span>, x <span class="op">=</span> <span class="st">"CSTV for RY=90%"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="bootstrapping_tutorial_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
</div>
</div>
<div class="section level3">
<h3 id="set-seed">
<code>set.seed()</code><a class="anchor" aria-label="anchor" href="#set-seed"></a>
</h3>
<p>Note the use of <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> prior to bootstrapping
ensures that results are reproducible. Even though random sampling is
being used, <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> gives “an integer vector, containing
the random number generator (RNG) state for random number generation in
R.” This means that next time the code is run, the same bootstrap
samples can be reproduced. Without <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>, your results
will vary (even if just slightly) each time the code is run.</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p><em>Davison, A., Hinkley, D. (1997). Bootstrap Methods and their
Application (Cambridge Series in Statistical and Probabilistic
Mathematics). Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511802843" class="external-link uri">https://doi.org/10.1017/CBO9780511802843</a></em></p>
<p><em>Efron, B. 1979. “Bootstrap Methods: Another Look at the
Jackknife.” The Annals of Statistics 7 (1). <a href="https://doi.org/10.1214/aos/1176344552" class="external-link uri">https://doi.org/10.1214/aos/1176344552</a></em></p>
<p><em>Efron, B., Tibshirani, R.J. 1993. “Efficient Bootstrap
Computations.” In, 338–57. Springer US. <a href="https://doi.org/10.1007/978-1-4899-4541-9_23" class="external-link uri">https://doi.org/10.1007/978-1-4899-4541-9_23</a></em></p>
<p><em>Faraway, J.J. 2014. Linear Models with r. 2nd ed. CRC press. NY.
USA. 270p. ISBN 9781439887332. <a href="https://julianfaraway.github.io/faraway/LMR/" class="external-link uri">https://julianfaraway.github.io/faraway/LMR/</a></em></p>
<div class="section level4">
<h4 id="additional-webpages-on-bootstrapping-in-r">Additional webpages on bootstrapping in R<a class="anchor" aria-label="anchor" href="#additional-webpages-on-bootstrapping-in-r"></a>
</h4>
<p><em>Bootstrap and Simulation for Nonlinear Models - nlraa <a href="https://femiguez.github.io/nlraa-docs/Bootstrapping.html" class="external-link uri">https://femiguez.github.io/nlraa-docs/Bootstrapping.html</a></em>
<em>(relevant to agriculture, and addresses resampling of residuals
instead of cases)</em></p>
<p><em>Bootstrap confidence intervals - tidymodels. <a href="https://rsample.tidymodels.org/articles/Applications/Intervals.html" class="external-link uri">https://rsample.tidymodels.org/articles/Applications/Intervals.html</a></em></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian A. Correndo, Austin Pearce, Deanna Osmond, Ignacio A. Ciampitti.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
